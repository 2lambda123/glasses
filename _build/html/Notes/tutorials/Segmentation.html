<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Transfer Learning" href="Transfer%20Learning.html" /><link rel="prev" title="Interpretability" href="Interpretability.html" />

    <meta name="generator" content="sphinx-4.3.1, furo 2021.11.23"/>
        <title>Segmentation - Glasses documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=7f0192ddeb2adecfbaa87ffbcf67d16358b30bc1" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=0af69da206d614734f649b27d4cdc2dd6c31f41d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: rgb(81,82,146);
  --color-brand-content: rgb(81,82,146);
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Glasses  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Glasses  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Interpretability.html">Interpretability</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Segmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Transfer%20Learning.html">Transfer Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../modules.html">glasses</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../benchmark.html">benchmark module</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../glasses.html">glasses package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../glasses.data.html">glasses.data package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../glasses.data.visualisation.html">glasses.data.visualisation package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.interpretability.html">glasses.interpretability package</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../glasses.models.html">glasses.models package</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../glasses.models.base.html">glasses.models.base package</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../glasses.models.classification.html">glasses.models.classification package</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.classification.alexnet.html">glasses.models.classification.alexnet package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.classification.base.html">glasses.models.classification.base package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.classification.deit.html">glasses.models.classification.deit package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.classification.densenet.html">glasses.models.classification.densenet package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.classification.efficientnet.html">glasses.models.classification.efficientnet package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.classification.fishnet.html">glasses.models.classification.fishnet package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.classification.mobilenet.html">glasses.models.classification.mobilenet package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.classification.regnet.html">glasses.models.classification.regnet package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.classification.resnest.html">glasses.models.classification.resnest package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.classification.resnet.html">glasses.models.classification.resnet package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.classification.resnetxt.html">glasses.models.classification.resnetxt package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.classification.senet.html">glasses.models.classification.senet package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.classification.vgg.html">glasses.models.classification.vgg package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.classification.vit.html">glasses.models.classification.vit package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.classification.wide_resnet.html">glasses.models.classification.wide_resnet package</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../glasses.models.segmentation.html">glasses.models.segmentation package</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.segmentation.base.html">glasses.models.segmentation.base package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.segmentation.fpn.html">glasses.models.segmentation.fpn package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../glasses.models.segmentation.unet.html">glasses.models.segmentation.unet package</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../glasses.models.utils.html">glasses.models.utils package</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../glasses.nn.html">glasses.nn package</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../glasses.nn.activation.html">glasses.nn.activation package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../glasses.nn.att.html">glasses.nn.att package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../glasses.nn.blocks.html">glasses.nn.blocks package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../glasses.nn.pool.html">glasses.nn.pool package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../glasses.nn.regularization.html">glasses.nn.regularization package</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../glasses.utils.html">glasses.utils package</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../glasses.utils.weights.html">glasses.utils.weights package</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../glasses.utils.weights.storage.html">glasses.utils.weights.storage package</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../../glasses.utils.weights.storage.hubs.html">glasses.utils.weights.storage.hubs package</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../models_table.html">models_table module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../setup.html">setup module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../transfer_weights.html">transfer_weights module</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../glasses.nn.html">glasses.nn package</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../glasses.nn.activation.html">glasses.nn.activation package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../glasses.nn.att.html">glasses.nn.att package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../glasses.nn.blocks.html">glasses.nn.blocks package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../glasses.nn.pool.html">glasses.nn.pool package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../glasses.nn.regularization.html">glasses.nn.regularization package</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../glasses.models.html">glasses.models package</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../glasses.models.base.html">glasses.models.base package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../glasses.models.classification.html">glasses.models.classification package</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.classification.alexnet.html">glasses.models.classification.alexnet package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.classification.base.html">glasses.models.classification.base package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.classification.deit.html">glasses.models.classification.deit package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.classification.densenet.html">glasses.models.classification.densenet package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.classification.efficientnet.html">glasses.models.classification.efficientnet package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.classification.fishnet.html">glasses.models.classification.fishnet package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.classification.mobilenet.html">glasses.models.classification.mobilenet package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.classification.regnet.html">glasses.models.classification.regnet package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.classification.resnest.html">glasses.models.classification.resnest package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.classification.resnet.html">glasses.models.classification.resnet package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.classification.resnetxt.html">glasses.models.classification.resnetxt package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.classification.senet.html">glasses.models.classification.senet package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.classification.vgg.html">glasses.models.classification.vgg package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.classification.vit.html">glasses.models.classification.vit package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.classification.wide_resnet.html">glasses.models.classification.wide_resnet package</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../glasses.models.segmentation.html">glasses.models.segmentation package</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.segmentation.base.html">glasses.models.segmentation.base package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.segmentation.fpn.html">glasses.models.segmentation.fpn package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../glasses.models.segmentation.unet.html">glasses.models.segmentation.unet package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../glasses.models.utils.html">glasses.models.utils package</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../glasses.utils.html">glasses.utils package</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../glasses.utils.weights.html">glasses.utils.weights package</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../glasses.utils.weights.storage.html">glasses.utils.weights.storage package</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../glasses.utils.weights.storage.hubs.html">glasses.utils.weights.storage.hubs package</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../glasses.data.html">glasses.data package</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../glasses.data.visualisation.html">glasses.data.visualisation package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../glasses.interpretability.html">glasses.interpretability package</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="segmentation">
<h1>Segmentation<a class="headerlink" href="#segmentation" title="Permalink to this headline">¶</a></h1>
<section id="preambula">
<h2>Preambula<a class="headerlink" href="#preambula" title="Permalink to this headline">¶</a></h2>
<p>To get started you need to install glasses, this can be done through <code class="docutils literal notranslate"><span class="pre">pip</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install git+https://github.com/FrancescoSaverioZuppichini/glasses
</pre></div>
</div>
</section>
<section id="id1">
<h2>Segmentation<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Segmentation models can be found in <code class="docutils literal notranslate"><span class="pre">glasses.models.segmentation</span></code>. Easily</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">glasses.models.segmentation</span> <span class="kn">import</span> <span class="n">UNet</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">384</span><span class="p">,</span> <span class="mi">384</span><span class="p">))</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">UNet</span><span class="p">(</span><span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">384</span><span class="p">,</span> <span class="mi">384</span><span class="p">])</span>
</pre></div>
</div>
<section id="change-encoder">
<h3>Change Encoder<a class="headerlink" href="#change-encoder" title="Permalink to this headline">¶</a></h3>
<p>In glasses you can on the fly change the encoder of each segmentation model. Each segmentation model inherits from <code class="docutils literal notranslate"><span class="pre">SegmentationModule</span></code> and expects a <code class="docutils literal notranslate"><span class="pre">Encoder</span></code> instance.</p>
<p>All glasses classification models are composed of an <strong>encoder</strong> and a <strong>head</strong>, thus changing the encoder is as easy as pass it as a parameter</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">glasses.models.classification.resnet</span> <span class="kn">import</span> <span class="n">ResNetEncoder</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">384</span><span class="p">,</span> <span class="mi">384</span><span class="p">))</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">UNet</span><span class="p">(</span><span class="n">encoder</span><span class="o">=</span><span class="n">ResNetEncoder</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">192</span><span class="p">])</span>
</pre></div>
</div>
<p>Notice how the output is twice as small as in the standard u-net, this is why resnet has 4 stages, a.k.a four layers that reduce by half the input resolution. To match the correct input shape we have to upsample one more. In other words, we need to increase the widths of the net decoder.</p>
<p>Similar to classification models, each segmentation model is composed by three sub-modules: <strong>encoder</strong>, <strong>decoder</strong> and <strong>head</strong>. So, we can easily compose them to create any custom model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">glasses.models.segmentation.unet</span> <span class="kn">import</span> <span class="n">UNetDecoder</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">384</span><span class="p">,</span> <span class="mi">384</span><span class="p">))</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">UNet</span><span class="p">(</span><span class="n">encoder</span><span class="o">=</span><span class="n">ResNetEncoder</span><span class="p">,</span> <span class="n">decoder</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">UNetDecoder</span><span class="p">,</span> <span class="n">widths</span><span class="o">=</span><span class="p">[</span><span class="mi">512</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">]),</span> <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">384</span><span class="p">,</span> <span class="mi">384</span><span class="p">])</span>
</pre></div>
</div>
<p>We used <code class="docutils literal notranslate"><span class="pre">partial</span></code> to change the <code class="docutils literal notranslate"><span class="pre">widths</span></code> parameter of the decoder to match the encoder’s stages. Each segmentation model has the <code class="docutils literal notranslate"><span class="pre">.from_encoder</span></code> method that takes a model as input and automatically the model with that model’s encoder.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">glasses.models</span> <span class="kn">import</span> <span class="n">AutoModel</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">384</span><span class="p">,</span> <span class="mi">384</span><span class="p">))</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">UNet</span><span class="o">.</span><span class="n">from_encoder</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">AutoModel</span><span class="o">.</span><span class="n">from_name</span><span class="p">,</span> <span class="s1">'efficientnet_b1'</span><span class="p">),</span> <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">192</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="pretrained-encoders">
<h3>Pretrained encoders<a class="headerlink" href="#pretrained-encoders" title="Permalink to this headline">¶</a></h3>
<p>Easily, we can pass a pretrained network using <code class="docutils literal notranslate"><span class="pre">AutoModel</span></code>. In this case, pretrained models on ImageNet expects an input with 3 channels</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">glasses.models</span> <span class="kn">import</span> <span class="n">AutoModel</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">384</span><span class="p">,</span> <span class="mi">384</span><span class="p">))</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">UNet</span><span class="o">.</span><span class="n">from_encoder</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">AutoModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">,</span> <span class="s1">'efficientnet_b1'</span><span class="p">),</span> <span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INFO</span><span class="p">:</span><span class="n">root</span><span class="p">:</span><span class="n">Loaded</span> <span class="n">efficientnet_b1</span> <span class="n">pretrained</span> <span class="n">weights</span><span class="o">.</span>





<span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">192</span><span class="p">])</span>
</pre></div>
</div>
<p>What if we would like to use an input with different channels than 3? We need to replace the stem.</p>
<p><strong>I <a class="reference external" href="https://github.com/FrancescoSaverioZuppichini/glasses/issues/179">am working</a> on a way to load only a specific subset of weights, so we can directly create a model with a different stem but with all the rest of the weights pretrained</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">glasses.models.classification.resnet</span> <span class="kn">import</span> <span class="n">ResNetStem</span>
    
<span class="k">def</span> <span class="nf">get_encoder</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">AutoModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s1">'resnet50'</span><span class="p">)</span>
    <span class="c1"># replace the stem</span>
    <span class="n">model</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">stem</span> <span class="o">=</span> <span class="n">ResNetStem</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">start_features</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">encoder</span>
    
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">384</span><span class="p">,</span> <span class="mi">384</span><span class="p">))</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">UNet</span><span class="p">(</span><span class="n">encoder</span><span class="o">=</span><span class="n">get_encoder</span><span class="p">,</span> <span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INFO</span><span class="p">:</span><span class="n">root</span><span class="p">:</span><span class="n">Loaded</span> <span class="n">resnet50</span> <span class="n">pretrained</span> <span class="n">weights</span><span class="o">.</span>





<span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">192</span><span class="p">])</span>
</pre></div>
</div>
<p>The APIs are shared from all segmentation models. For example, we can also import PFPN (<a class="reference external" href="https://arxiv.org/pdf/1901.02446.pdf">Panoptic Feature Pyramid Networks</a>) and keep the same code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">glasses.models</span> <span class="kn">import</span> <span class="n">AutoModel</span>
<span class="kn">from</span> <span class="nn">glasses.models.segmentation</span> <span class="kn">import</span> <span class="n">PFPN</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">384</span><span class="p">,</span> <span class="mi">384</span><span class="p">))</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">PFPN</span><span class="o">.</span><span class="n">from_encoder</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">AutoModel</span><span class="o">.</span><span class="n">from_name</span><span class="p">,</span> <span class="s1">'efficientnet_b1'</span><span class="p">),</span> <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">384</span><span class="p">,</span> <span class="mi">384</span><span class="p">])</span>
</pre></div>
</div>
<p>In this case the output always match the input, this is due to how PFPN works.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="Transfer%20Learning.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Transfer Learning</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="Interpretability.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Interpretability</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2020, Francesco Saverio Zuppichini &amp; Francesco Cicala |
          Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
          <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            | <a class="muted-link" href="../../_sources/Notes/tutorials/Segmentation.md.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Segmentation</a><ul>
<li><a class="reference internal" href="#preambula">Preambula</a></li>
<li><a class="reference internal" href="#id1">Segmentation</a><ul>
<li><a class="reference internal" href="#change-encoder">Change Encoder</a></li>
<li><a class="reference internal" href="#pretrained-encoders">Pretrained encoders</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    </body>
</html>